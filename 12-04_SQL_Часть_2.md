# Домашнее задание к занятию «SQL. Часть 2» - `Юрий Чеканов`

Задание можно выполнить как в любом IDE, так и в командной строке.

### Задание 1

Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию:

- фамилия и имя сотрудника из этого магазина;
- город нахождения магазина;
- количество пользователей, закреплённых в этом магазине.

```mysql
select c.store_id, CONCAT(s.first_name, ' ', s.last_name) as 'Staff Name', 
c2.city as 'Store location', count(c.store_id) as Active_Customers
from customer c
right join store s2 on s2.store_id = c.store_id
right join address a on a.address_id = s2.store_id
right join city c2 on c2.city_id = a.city_id 
right join staff s on s.staff_id  = s2.manager_staff_id 
where c.active <> '0'
group by store_id having Active_Customers > 300
```

| store_id | Staff Name   | city       | Active_Customers |
| -------- | ------------ | ---------- | ---------------- |
| 1        | Mike Hillyer | Lethbridge | 318              |

### Задание 2

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

### Задание 3

Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.

### Задание 4*

Посчитайте количество продаж, выполненных каждым продавцом. Добавьте вычисляемую колонку «Премия». Если количество продаж превышает 8000, то значение в колонке будет «Да», иначе должно быть значение «Нет».

### Задание 5*

Найдите фильмы, которые ни разу не брали в аренду.